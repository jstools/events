!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Azazel=t()}(this,function(){"use strict";var a=function(){if("object"==typeof process&&process&&"function"==typeof process.nextTick)return process.nextTick;if("MutationObserver"in window||"WebKitMutationObserver"in window)return function(n,t){var e=[],i=0;function o(){t.data=i=++i%2}return new n(function(){var n=e.shift();0<e.length&&o(),n instanceof Function&&n()}).observe(t,{characterData:!0}),function(n){e.push(n),o()}}(window.MutationObserver||window.WebKitMutationObserver,document.createTextNode(""));var t=function(n){if("function"!=typeof n)throw new TypeError(n+" is not a Function");return n};return"function"==typeof setImmediate?function(n){setImmediate(t(n))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(n){setTimeout(t(n),0)}:void 0}(),p=function(n){n.apply(this,arguments)};function h(n,t){for(var e=n.length-1;0<=e;e--)t===n[e]&&n.splice(e,1)}function d(o,r,f){return function t(n,e,i){if(!1!==f&&!(e instanceof Function))throw new Error("listener should be a Function");if(n instanceof Array)return n.forEach(function(n){t(n,e,i)}),r;if("string"!=typeof n)throw new Error("event_name should be a string");return/ /.test(n)?t(n.split(/ +/),e,i):(o.apply(this,arguments),r)}}function l(o,n){"string"==typeof(n=n||{})&&(n={prefix:n}),n.prefix=n.prefix||"",o=o||(this instanceof l?this:{});var r={},f={},u={},c=!1!==n.async?a:p;function s(n,t,e){r[n]=r[n]||[],e?r[n].unshift(t):r[n].push(t)}var t=d(s,o);var e=d(function(n,t,e){f[n]=f[n]||[],e?f[n].unshift(t):f[n].push(t)},o);var i=d(function(n,t,e,i){e instanceof Function&&(i=e,e=null),c(function(){u[n]={args:t,this_arg:e},r[n]&&r[n].forEach(function(n){n.apply(e,t||[])}),f[n]&&(function(n,t,e){for(var i in n.forEach(function(n){n.apply(e,t||[])}),f)f[i]!==n&&n.forEach(function(n){f[i]&&h(f[i],n)})}(f[n],t,e),delete f[n]),i instanceof Function&&i.apply(e,t||[])})},o,!1);return o[n.prefix+"on"]=t,o[n.prefix+"once"]=e,o[n.prefix+"watch"]=function(n,t,e){if(!(t instanceof Function))throw new Error("listener should be a Function");var i=u[n];return i&&t.apply(i.this_arg,i.args),i&&"once"===e||s(n,t,e),o},o[n.prefix+"emit"]=i,o[n.prefix+"off"]=d(function(n,t){r[n]&&h(r[n],t),f[n]&&h(f[n],t)}),o}return l.nextTick=a,l});