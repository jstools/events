!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Azazel=t()}(this,function(){"use strict";var p=function(){if("object"==typeof process&&process&&"function"==typeof process.nextTick)return process.nextTick;if("MutationObserver"in window||"WebKitMutationObserver"in window)return function(n,t){var e=[],i=0;function o(){t.data=i=++i%2}return new n(function(){var n=e.shift();0<e.length&&o(),n instanceof Function&&n()}).observe(t,{characterData:!0}),function(n){e.push(n),o()}}(window.MutationObserver||window.WebKitMutationObserver,document.createTextNode(""));var t=function(n){if("function"!=typeof n)throw new TypeError(n+" is not a Function");return n};return"function"==typeof setImmediate?function(n){setImmediate(t(n))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(n){setTimeout(t(n),0)}:void 0}(),h=function(n){n.apply(this,arguments)};function d(n,t){for(var e=n.length-1;0<=e;e--)t===n[e]&&n.splice(e,1)}function l(o,r,f){return function t(n,e,i){if(!1!==f&&!(e instanceof Function))throw new Error("listener should be a Function");if(n instanceof Array)return n.forEach(function(n){t(n,e,i)}),r;if("string"!=typeof n)throw new Error("event_name should be a string");return/ /.test(n)?t(n.split(/ +/),e,i):(o.apply(this,arguments),r)}}function v(o,n){"string"==typeof(n=n||{})&&(n={prefix:n}),n.prefix=n.prefix||"",o=o||(this instanceof v?this:{});var r={},f={},c={},u=!1!==n.async?p:h;function a(n,t,e){r[n]=r[n]||[],e?r[n].unshift(t):r[n].push(t)}var t=l(a,o);function s(n,t,e){f[n]=f[n]||[],e?f[n].unshift(t):f[n].push(t)}var e=l(s,o);var i=l(function(t,e,i,o){i instanceof Function&&(o=i,i=null),u(function(){c[t]={args:e,this_arg:i};var n=r[t];n&&n.forEach(function(n){n.apply(i,e||[])}),function(t,e,i){var n=f[t];if(delete f[t],n)for(var t in n.forEach(function(n){n.apply(i,e||[])}),f)f[t]!==n&&n.forEach(function(n){f[t]&&d(f[t],n)})}(t,e,i),o instanceof Function&&o.apply(i,e||[])})},o,!1);return o[n.prefix+"on"]=t,o[n.prefix+"once"]=e,o[n.prefix+"watch"]=function(n,t,e){if(!(t instanceof Function))throw new Error("listener should be a Function");var i=c[n];return i?t.apply(i.this_arg,i.args):"once"===e&&s(n,t,e),"once"!==e&&a(n,t,e),o},o[n.prefix+"emit"]=i,o[n.prefix+"off"]=l(function(n,t){r[n]&&d(r[n],t),f[n]&&d(f[n],t)}),o}return v.nextTick=p,v});