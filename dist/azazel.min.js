!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Azazel=t()}(this,function(){"use strict";var s=function(n,t){if("nextTick"in n)return n.nextTick;for(var e in t)if(n[e+"equestAnimationFrame"]instanceof Function)return n[e+"equestAnimationFrame"];return setTimeout}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"r, webkitR, mozR, oR, msR".split(/ *, */)),p=function(n){n.apply(this,arguments)};function l(n,t){for(var e=n.length-1;0<=e;e--)t===n[e]&&n.splice(e,1)}function h(o,r,f){return function t(n,e,i){if(!1!==f&&!(e instanceof Function))throw new Error("listener should be a Function");if(n instanceof Array)return n.forEach(function(n){t(n,e,i)}),r;if("string"!=typeof n)throw new Error("event_name should be a string");return/ /.test(n)?t(n.split(/ +/),e,i):(o.apply(this,arguments),r)}}function d(o,n){"string"==typeof(n=n||{})&&(n={prefix:n}),n.prefix=n.prefix||"",o=o||(this instanceof d?this:{});var i={},r={},f={},u=!1!==n.async?s:p;function c(n,t,e){i[n]=i[n]||[],e?i[n].unshift(t):i[n].push(t)}var t=h(c,o);var e=h(function(n,t,e){r[n]=r[n]||[],e?r[n].unshift(t):r[n].push(t)},o);var a=h(function(n,t,e){u(function(){f[n]={args:t,this_arg:e},i[n]&&i[n].forEach(function(n){n.apply(e,t||[])}),r[n]&&(function(n,t,e){for(var i in n.forEach(function(n){n.apply(e,t||[])}),r)r[i]!==n&&n.forEach(function(n){r[i]&&l(r[i],n)})}(r[n],t,e),delete r[n])})},o,!1);return o[n.prefix+"on"]=t,o[n.prefix+"once"]=e,o[n.prefix+"watch"]=function(n,t,e){if(!(t instanceof Function))throw new Error("listener should be a Function");var i=f[n];return i&&t.apply(i.this_arg,i.args),i&&"once"===e||c(n,t,e),o},o[n.prefix+"emit"]=a,o[n.prefix+"off"]=h(function(n,t){i[n]&&l(i[n],t),r[n]&&l(r[n],t)}),o}return d.nextTick=s,d});