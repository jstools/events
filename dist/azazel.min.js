!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Azazel=t()}(this,function(){"use strict";function s(n,t){for(var o=n.length-1;0<=o;o--)t===n[o]&&n.splice(o,1)}function h(i,r,f){return function t(n,o,e){if(!1!==f&&!(o instanceof Function))throw new Error("listener should be a Function");if(n instanceof Array)return n.forEach(function(n){t(n,o,e)}),r;if("string"!=typeof n)throw new Error("event_name should be a string");return/ /.test(n)?t(n.split(/ +/),o,e):(i.apply(this,arguments),r)}}return function n(i,t){t=t||"";var e={},r={},f={};function u(n,t,o){e[n]=e[n]||[],o?e[n].unshift(t):e[n].push(t)}var o=h(u,i=i||(this instanceof n?this:{}));var c=h(function(n,t,o){r[n]=r[n]||[],o?r[n].unshift(t):r[n].push(t)},i);var a=h(function(n,t,o){f[n]={args:t,this_arg:o},e[n]&&e[n].forEach(function(n){n.apply(o,t||[])}),r[n]&&(function(n,t,o){for(var e in n.forEach(function(n){n.apply(o,t||[])}),r)r[e]!==n&&n.forEach(function(n){r[e]&&s(r[e],n)})}(r[n],t,o),delete r[n])},i,!1);return i[t+"on"]=o,i[t+"once"]=c,i[t+"watch"]=function(n,t,o){if(!(t instanceof Function))throw new Error("listener should be a Function");var e=f[n];return e&&t.apply(e.this_arg,e.args),e&&"once"===o||u(n,t,o),i},i[t+"emit"]=a,i[t+"off"]=h(function(n,t){e[n]&&s(e[n],t),r[n]&&s(r[n],t)}),i}});